<% content_for :title, "Öffentliche Templates" %>

<div class="page">
  <!-- Sidebar: Filter -->
  <aside class="filter-panel">
    <h3>Filter</h3>

    <%= form_with url: latex_templates_path, method: :get, local: true, class: "filter-form" do %>
      <div class="form-group">
        <label>Suche</label>
        <input type="text" name="q" value="<%= params[:q] %>" class="input" placeholder="Titel oder Beschreibung…">
      </div>

      <div class="form-group">
        <label>Sichtbarkeit</label>
        <div class="radio">
          <%= radio_button_tag :visibility, "public", params[:visibility] == "public", id: "vis_public" %>
          <%= label_tag "vis_public", "public" %>
        </div>
        <div class="radio">
          <%= radio_button_tag :visibility, "private", params[:visibility] == "private", id: "vis_private" %>
          <%= label_tag "vis_private", "private" %>
        </div>
      </div>

      <div class="form-group">
        <label>Eigentümer</label>
        <input type="text" name="owner" value="<%= params[:owner] %>" class="input" placeholder="E-Mail oder Name">
      </div>

      <div class="actions">
        <button class="btn" type="submit">Anwenden</button>
        <%= link_to "Zurücksetzen", latex_templates_path, class: "btn ghost" %>
      </div>
    <% end %>
  </aside>

  <!-- Main: Grid -->
  <main class="templates-area">
    <div class="toolbar">
      <h1>Öffentliche Templates</h1>
      <%= link_to "Neues Template", new_latex_template_path, class: "btn-primary" %>
    </div>

    <% if @latex_templates.blank? %>
      <div class="empty-state">Keine Templates gefunden.</div>
    <% else %>
      <div class="templates-grid">
        <% @latex_templates.each do |lt| %>
          <article class="template-card" id="<%= dom_id(lt) %>">
            <header>
              <h3><%= lt.title %></h3>
              <span class="badge <%= lt.visibility %>"><%= lt.visibility %></span>
            </header>

            <p class="description"><%= truncate(lt.description.to_s, length: 120) %></p>

            <footer class="card-actions">
              <%= link_to "Anzeigen", latex_template_path(lt), class: "btn ghost" %>
              <%= link_to "Dokument", new_document_latex_template_path(lt), class: "btn" %>
            </footer>
          </article>
        <% end %>
      </div>
    <% end %>
  </main>
</div>
