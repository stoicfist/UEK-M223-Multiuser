<% content_for :title, "Öffentliche Templates" %>

<div class="page">
  <!-- Sidebar: Filter -->
  <aside class="filter-panel">
    <h3>Filter</h3>

    <%= form_with url: latex_templates_path, method: :get, local: true, class: "filter-form" do %>
      <div class="form-group">
        <%= label_tag :q, "Suche" %>
        <%= text_field_tag :q, params[:q], placeholder: "Titel oder Beschreibung...", class: "input" %>
      </div>

      <div class="form-group">
        <div class="label">Sichtbarkeit</div>
        <div class="radios two-col">
          <input  type="radio" id="vis_all"    name="visibility" value=""
                  <%= "checked" if params[:visibility].blank? %>>
          <label for="vis_all">alle</label>

          <input  type="radio" id="vis_pub"    name="visibility" value="public"
                  <%= "checked" if params[:visibility] == "public" %>>
          <label for="vis_pub">public</label>

          <input  type="radio" id="vis_priv"   name="visibility" value="private"
                  <%= "checked" if params[:visibility] == "private" %>>
          <label for="vis_priv">private</label>
        </div>
      </div>

      <div class="form-group">
        <%= label_tag :owner_email, "Eigentümer" %>
        <%= text_field_tag :owner_email, params[:owner_email], placeholder: "E-Mail oder Name", class: "input" %>
      </div>

      <div class="actions">
        <%= submit_tag "Anwenden", class: "btn" %>
        <%= link_to "Zurücksetzen", latex_templates_path, class: "btn ghost" %>
      </div>
    <% end %>
  </aside>

  <!-- Main: Grid -->
  <main class="templates-area">
    <div class="toolbar">
      <h1>Öffentliche Templates</h1>
      <%= link_to "Neues Template", new_latex_template_path, class: "btn-primary" %>
    </div>

    <% if @latex_templates.blank? %>
      <div class="empty-state">Keine Templates gefunden.</div>
    <% else %>
      <div class="templates-grid">
        <% @latex_templates.each do |lt| %>
          <article class="template-card" id="<%= dom_id(lt) %>">
            <header>
              <h3><%= lt.title %></h3>
              <span class="badge <%= lt.visibility %>"><%= lt.visibility %></span>
            </header>

            <p class="description"><%= truncate(lt.description.to_s, length: 120) %></p>

            <footer class="card-actions">
              <%= link_to "Anzeigen", latex_template_path(lt), class: "btn ghost" %>
              <%= link_to "Dokument", new_document_latex_template_path(lt), class: "btn" %>
            </footer>
          </article>
        <% end %>
      </div>
    <% end %>
  </main>
</div>
