<% content_for :title, @latex_template.title %>

<div class="page-wrap"><!-- NEU: sorgt für Außenabstand und max-width -->

  <nav class="breadcrumb">
    <%= link_to "Templates", latex_templates_path %> › <span><%= @latex_template.title %></span>
  </nav>

  <div class="show-layout">
    <!-- Linke Spalte -->
    <aside class="side">
      <h1 class="page-title"><%= @latex_template.title %></h1>

      <div class="info-card">
        <div class="info-lines">
          <p><strong>Eigentümer:</strong> <%= @latex_template.user&.email || "unbekannt" %></p>
          <p><strong>Sichtbarkeit:</strong> <%= @latex_template.visibility %></p>
          <p><strong>Benutzt:</strong> <%= @latex_template.documents.count rescue 0 %>x</p>
        </div>

        <div class="card-actions">
          <%= link_to "Template klonen",
                      new_document_latex_template_path(@latex_template),
                      class: "btn-primary btn-block" %>
        </div>
      </div>
    </aside>

    <!-- Rechte Spalte -->
    <section class="main">
      <div class="toolbar">
        <%= link_to "Zur Galerie", latex_templates_path, class: "btn-secondary" %>
      </div>

      <div class="preview-panel">
        <h2>Vorschau (Auszug)</h2>

        <% lines = @latex_template.body.to_s.lines.map(&:strip) %>
        <div class="preview-snippet"><code><%= lines[0].presence || "% (leer)" %></code></div>
        <div class="preview-snippet"><code><%= lines.find { _1.start_with?('\\begin{document}') } || "% (kein \\begin{document})" %></code></div>

        <details class="code-details">
          <summary>Kompletten LaTeX-Code anzeigen</summary>
          <pre class="code-block"><%= @latex_template.body %></pre>
        </details>
      </div>
    </section>
  </div>
</div>
